<html>
    <head>
        <title>Self Tracker from My Phone</title>
    </head>
    <body>
        <div id="inputDivs"></div>

        <script>
            let inputs;
            let dates = [];

            window.onload = function(e){
                getInputs();
            };

            function getInputs(){
                fetch('/api').then(result => {
                    return result.json();
                }).then(result => {
                    //console.log(result);
                    inputs = result;

                    for(let i = 0; i < inputs.length; i++){
                        let thisDateArray = inputs[i].date.split(' ');
                        let thisDate = thisDateArray[0] + "-" + thisDateArray[1] + "-" + thisDateArray[2];
                        if(indexOf(thisDate) < 0){
                            dates.push(thisDate);

                            let div = document.createElement('div');
                            div.id = thisDate;
                            document.getElementById('inputDivs').appendChild(div);
                        }

                        baseToImage(inputs[i], thisDate);

                    }
                }).catch(err => {
                    return err;
                })
            }

            function baseToImage(input, dest){

                console.log(input);

                let bString = input.img;
                let img = document.createElement('img');
                img.width = 320;
                img.height = 240;
                img.src = "data:image/jpeg;base64," + bString;
                document.getElementById(dest).appendChild(img);

                console.log(input.imgDate);

                let newDate = document.createElement('P');
                newDate.setAttribute('class', 'date');
                newDate.innerHTML = input.imgDate;
                document.getElementById(dest).appendChild(newDate);

                let newLoc = document.createElement('p');
                newLoc.setAttribute('class', 'loc');
                newLoc.innerHTML = input.imgLoc;
                document.getElementById(dest).appendChild(newLoc);

            }

        </script>
    </body>
</html>